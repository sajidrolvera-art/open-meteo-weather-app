<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Open-Meteo - Consulta de Clima</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#7dd3fc;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin:0; background:linear-gradient(180deg,#071226 0%, #071a2a 100%); color:#e6eef6; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px}
    .app{width:100%; max-width:920px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:20px; box-shadow:0 10px 30px rgba(2,6,23,0.6); display:grid; grid-template-columns:360px 1fr; gap:20px}
    .panel{background:var(--card); border-radius:10px; padding:16px}
    h1{margin:0 0 6px;font-size:18px}
    label{display:block;font-size:13px;color:var(--muted); margin-top:12px}
    input[type="text"], input[type="number"]{width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:var(--glass); color:inherit}
    button{margin-top:12px;padding:10px 12px;border-radius:8px;border:none;background:var(--accent); color:#06202b; font-weight:600; cursor:pointer}
    .small{font-size:13px;color:var(--muted)}
    .result{display:flex; flex-direction:column; gap:14px}
    .weather-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:18px; border-radius:10px; display:flex; align-items:center; justify-content:space-between}
    .temp{font-size:48px; font-weight:700}
    .meta{color:var(--muted); font-size:14px}
    .history{max-height:260px; overflow:auto; margin-top:10px; display:flex; flex-direction:column; gap:8px}
    .history button{background:transparent; border:1px solid rgba(255,255,255,0.03); color:var(--muted); padding:8px; border-radius:8px; text-align:left}
    .footer{font-size:12px;color:var(--muted); margin-top:12px}
    .right{padding:8px 16px}
    .maplike{height:280px; background:linear-gradient(90deg,#03101a,#061426); border-radius:8px; display:flex; align-items:center; justify-content:center; color:var(--muted)}
    .coords{display:flex; gap:8px; margin-top:10px}
    @media (max-width:880px){.app{grid-template-columns:1fr; padding:12px}}
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Consulta de clima Open-Meteo">
    <aside class="panel" aria-labelledby="panelTitle">
      <h1 id="panelTitle">Buscar clima</h1>
      <p class="small">Usa ciudad o coordenadas. También puedes usar <strong>Mi ubicación</strong>.</p>

      <label for="city">Ciudad (ej: Mexico City)</label>
      <input id="city" type="text" placeholder="Escribe una ciudad y presiona Buscar" />
      <button id="searchCity">Buscar ciudad</button>

      <label for="lat">Latitud</label>
      <input id="lat" type="number" step="any" placeholder="Ej: 19.4326" />

      <label for="lon">Longitud</label>
      <input id="lon" type="number" step="any" placeholder="Ej: -99.1332" />

      <div class="coords">
        <button id="useLoc">Mi ubicación</button>
        <button id="getWeather">Consultar clima</button>
      </div>

      <div class="footer">Resultados guardados en el historial local. Haz clic en un registro para consultar de nuevo.</div>

      <h2 style="margin-top:14px;font-size:14px">Historial</h2>
      <div class="history" id="history" role="list" aria-label="Historial de consultas"></div>
    </aside>

    <main class="panel right" aria-live="polite">
      <div id="content" class="result">
        <div class="maplike" id="mapLike">Panel de visualización</div>

        <div id="weatherOutput" style="display:none">
          <div class="weather-card">
            <div>
              <div id="place" style="font-weight:700;font-size:16px">—</div>
              <div class="meta" id="tim